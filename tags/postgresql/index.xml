<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Postgresql on 补漏砖匠</title><link>/tags/postgresql/</link><description>Recent content in Postgresql on 补漏砖匠</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Thu, 27 Nov 2025 00:00:00 +0000</lastBuildDate><atom:link href="/tags/postgresql/index.xml" rel="self" type="application/rss+xml"/><item><title>典籍篇</title><link>/%E5%90%8E%E7%AB%AF%E6%9E%B6%E6%9E%84/%E6%95%B0%E6%8D%AE%E5%BA%93-PostgreSQL%E5%AE%89%E8%A3%85/</link><pubDate>Thu, 27 Nov 2025 00:00:00 +0000</pubDate><guid>/%E5%90%8E%E7%AB%AF%E6%9E%B6%E6%9E%84/%E6%95%B0%E6%8D%AE%E5%BA%93-PostgreSQL%E5%AE%89%E8%A3%85/</guid><description>◀ 返回
PostgreSQL 安装 创建用户与环境配置 创建用户 groupadd postgres useradd -g postgres postgres 环境变量配置(.bash_profile) export PGPORT=5433 export PG_HOME=/usr/local/pg16.2 export PATH=$PG_HOME/bin:$PATH export PGDATA=$PG_HOME/data export LD_LIBRARY_PATH=$PG_HOME/lib export LANG=en_US.utf8 内核参数配置 vi /etc/sysctl.conf #最大共享内存段大小 kernel.shmmax = 68719476736(默认) #可以使用的共享内存的总量 kernel.shmall = 4294967296(默认) #整个系统共享内存段的最大数目 kernel.shmmni = 4096 #每个信号对象集的最大信号对象数 kernel.sem = 50100 64128000 50100 1280 #文件句柄的最大数量。 fs.file-max = 7672460 #应用程序可使用的IPv4端口范围 net.ipv4.ip_local_port_range = 9000 65000 #套接字接收缓冲区大小的缺省值 net.core.rmem_default = 1048576 #套接字发送缓冲区大小的缺省 net.core.wmem_default = 262144 值 #套接字发送缓冲区大小的最大值 net.core.wmem_max = 1048576 # sysctl -p #配置生效 centos7 源码安装 下载</description></item><item><title>典籍篇</title><link>/%E5%90%8E%E7%AB%AF%E6%9E%B6%E6%9E%84/%E6%95%B0%E6%8D%AE%E5%BA%93-PostgreSQL%E7%BB%84%E6%88%90%E7%BB%93%E6%9E%84/</link><pubDate>Thu, 27 Nov 2025 00:00:00 +0000</pubDate><guid>/%E5%90%8E%E7%AB%AF%E6%9E%B6%E6%9E%84/%E6%95%B0%E6%8D%AE%E5%BA%93-PostgreSQL%E7%BB%84%E6%88%90%E7%BB%93%E6%9E%84/</guid><description>◀ 返回
postgresql 的组成结构 内存 Local memory area:由每个后端进程分配给自己使用。
Share memory area: 由 postgresql 服务器的所有进程使用。
work_mem: 执行器执行 order by、distinct、join tables、hash-join操作时使用。
maintenance_work_mem: vacuum 归整、reindex重建索引，时使用。
temp_buffers: 临时表使用。
shared_buffer_pool: 从持久化的存储加载表页和索引页到此。
wal_buffer: 防止服务异常停止导致数据没有落盘，创建了 wal 缓冲区，相当于 redo log。
commit log: 记录所有的事务状态如:再处理，已提交、回退，保持事务的一致性。相当于 undo log。
进程 PostgreSQL 采用 C/S 模式，系统为每个连接的客户端分配一个服务进程 Postgres 当运行 pg_ctl 命令进入 Postgres 程序时，其进程创建流程如下:
PostMaster PostMaster：进程是整个数据库实例的总控进程，负责启动关闭该数据实例。并且在服务进程出现错误时完成系统的恢复，还要在系统奔溃的时候重启系统。它是运行在服务器上的总控进程，同时也负责整个系统范围内的操作，例如中断操作与信号处理。但是 Postmaster 本身并不执行这些操作，而是指派一个子进程在适当的时间处理它们。Postmaster 进程在起始时会创建共享内存与信号库，用于与子进程的通信，同时也能在某个子进程奔溃的时候重置共享内存即可恢复。 Postmaster 守护进程的执行流程如下
SysLogger SysLogger:（系统日志）进程,日志信息是数据库管理员获取数据库系统运行状态的有效手段。在数据库出现故障时，日志信息是非常有用的。把数据库日志信息集中输出到一个位置将极大方便管理员维护数据库系统。然而，日志输出将产生大量数据（特别是在比较高的调试级别上），单文件保存时不利于日志文件的操作。因此，在SysLogger的配置选项中可以设置日志文件的大小，SysLogger会在日志文件达到指定的大小时关闭当前日志文件，产生新的日志文件。 # - Where to Log - log_destination = &amp;#39;stderr&amp;#39; # Valid values are combinations of # stderr, csvlog, jsonlog, syslog, and # eventlog, depending on platform.</description></item></channel></rss>